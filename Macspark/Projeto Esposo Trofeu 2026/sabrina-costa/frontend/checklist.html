<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist | Dashboard Sabrina</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <style>
        .task-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px -15px rgba(59, 130, 246, 0.35);
        }
    </style>
</head>
<body class="bg-gray-50" x-data="checklistApp()" x-init="init()">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                        <span class="ml-2 text-xl font-bold text-gray-900">Dashboard Sabrina</span>
                    </div>

                    <div class="hidden md:ml-10 md:flex md:space-x-4">
                        <a href="dashboard.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">
                            Dashboard
                        </a>
                        <a href="cronograma.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">
                            Cronograma
                        </a>
                        <a href="ganchos.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">
                            Ganchos
                        </a>
                        <a href="checklist.html" class="px-3 py-2 rounded-md text-sm font-medium bg-purple-50 text-purple-700">
                            Checklist
                        </a>
                        <a href="relatorios.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">
                            Relat√≥rios
                        </a>
                        <a href="configuracoes.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">
                            Configura√ß√µes
                        </a>
                    </div>
                </div>

                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <p class="text-xs text-gray-400">Progresso semanal</p>
                        <p class="text-sm font-semibold text-purple-600" x-text="completionText"></p>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <header class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">Checklist Operacional</h1>
                <p class="text-sm text-gray-600 mt-1">
                    Acompanhamento di√°rio para garantir consist√™ncia, qualidade e distribui√ß√£o dos conte√∫dos da Sabrina.
                </p>
            </div>

            <div class="flex flex-wrap gap-3">
                <button @click="markAll(true)"
                        class="inline-flex items-center px-3 py-2 border border-emerald-200 rounded-lg text-sm font-medium text-emerald-700 hover:bg-emerald-50 transition">
                    ‚úÖ Marcar tudo como feito
                </button>
                <button @click="markAll(false)"
                        class="inline-flex items-center px-3 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition">
                    üîÅ Reiniciar checklist
                </button>
            </div>
        </header>

        <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <template x-for="section in sections" :key="section.id">
                <article class="bg-white border border-gray-200 rounded-2xl shadow-sm p-6 flex flex-col task-card">
                    <header class="mb-4">
                        <h2 class="text-xl font-semibold text-gray-900 flex items-center justify-between">
                            <span x-text="section.title"></span>
                            <span class="text-xs font-semibold uppercase tracking-wide px-2.5 py-1 rounded-full"
                                  :class="section.badgeClass">
                                <span x-text="doneCount(section.tasks) + '/' + section.tasks.length"></span>
                            </span>
                        </h2>
                        <p class="text-sm text-gray-500 mt-1" x-text="section.subtitle"></p>
                    </header>

                    <div class="space-y-3 flex-1">
                        <template x-for="task in section.tasks" :key="task.id">
                            <label class="flex items-start space-x-3 rounded-xl border border-gray-200 hover:border-purple-200 hover:bg-purple-50/40 transition p-3 cursor-pointer">
                                <input type="checkbox" class="mt-1 h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"
                                       :checked="task.completed"
                                       @change="toggleTask(section.id, task.id, $event.target.checked)">
                                <div>
                                    <p class="text-sm font-medium text-gray-900" x-text="task.title"></p>
                                    <p class="text-xs text-gray-500 mt-1" x-text="task.description"></p>
                                </div>
                            </label>
                        </template>
                    </div>

                    <footer class="mt-4">
                        <p class="text-xs text-gray-400">
                            √öltima atualiza√ß√£o: <span x-text="formatRelative(section.updatedAt)"></span>
                        </p>
                    </footer>
                </article>
            </template>
        </section>

        <section class="mt-8 bg-white border border-gray-200 rounded-2xl shadow-sm p-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Notas r√°pidas</h2>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                <div class="bg-purple-50 border border-purple-100 rounded-xl p-4">
                    <p class="text-xs font-semibold uppercase text-purple-600 mb-1">Follow up</p>
                    <p class="text-sm text-purple-800">Registrar leads que responderam aos stories e enviar mensagens personalizadas.</p>
                </div>
                <div class="bg-blue-50 border border-blue-100 rounded-xl p-4">
                    <p class="text-xs font-semibold uppercase text-blue-600 mb-1">Feedback</p>
                    <p class="text-sm text-blue-800">Salvar prints dos coment√°rios positivos para inserir no relat√≥rio semanal.</p>
                </div>
                <div class="bg-emerald-50 border border-emerald-100 rounded-xl p-4">
                    <p class="text-xs font-semibold uppercase text-emerald-600 mb-1">Testes A/B</p>
                    <p class="text-sm text-emerald-800">Documentar varia√ß√µes de CTA testadas nos √∫ltimos 7 dias.</p>
                </div>
            </div>
        </section>
    </main>

    <script src="assets/js/api.js"></script>
    <script src="assets/js/auth.js"></script>
    <script>
        function checklistApp() {
            const STORAGE_KEY = 'dashboard-sabrina-checklist';
            return {
                sections: [],

                get completionText() {
                    const totalTasks = this.sections.reduce((acc, section) => acc + section.tasks.length, 0);
                    const doneTasks = this.sections.reduce((acc, section) => acc + this.doneCount(section.tasks), 0);
                    const percentage = totalTasks ? Math.round((doneTasks / totalTasks) * 100) : 0;
                    return `${doneTasks}/${totalTasks} (${percentage}%) conclu√≠do`;
                },

                init() {
                    this.sections = this.loadState() || this.buildChecklist();
                },

                buildChecklist() {
                    const now = new Date().toISOString();
                    return [
                        {
                            id: 'pre',
                            title: 'Pr√©-publica√ß√£o',
                            subtitle: 'Garantia de qualidade antes do conte√∫do ir ao ar.',
                            badgeClass: 'bg-purple-100 text-purple-700',
                            updatedAt: now,
                            tasks: [
                                {
                                    id: 'roteiro',
                                    title: 'Roteiro revisado',
                                    description: 'Confere gancho, CTA e promessas com o Tom Sabrina.',
                                    completed: false,
                                },
                                {
                                    id: 'midia',
                                    title: 'M√≠dia aprovada',
                                    description: 'V√≠deo final exportado, capa definida e trilha conferida.',
                                    completed: false,
                                },
                                {
                                    id: 'copy',
                                    title: 'Legenda pronta',
                                    description: 'Legenda validada com checklist de copy + hashtags do dia.',
                                    completed: false,
                                },
                                {
                                    id: 'link',
                                    title: 'Links e UTM',
                                    description: 'Link em bio e par√¢metros UTM conferidos para rastreio.',
                                    completed: false,
                                },
                            ],
                        },
                        {
                            id: 'publicacao',
                            title: 'Publica√ß√£o do dia',
                            subtitle: 'Execu√ß√£o da estrat√©gia na data planejada.',
                            badgeClass: 'bg-blue-100 text-blue-700',
                            updatedAt: now,
                            tasks: [
                                {
                                    id: 'post',
                                    title: 'Post publicado',
                                    description: 'Reels/carrossel subido com capa correta e tags marcadas.',
                                    completed: false,
                                },
                                {
                                    id: 'stories',
                                    title: 'Stories de apoio',
                                    description: 'Sequ√™ncia de stories complementares (bastidores + CTA).',
                                    completed: false,
                                },
                                {
                                    id: 'comunity',
                                    title: 'Engajamento inicial',
                                    description: 'Responder coment√°rios nas primeiras 2 horas.',
                                    completed: false,
                                },
                                {
                                    id: 'whatsapp',
                                    title: 'Envio WhatsApp',
                                    description: 'Mensagem gatilho via Evolution API para leads quentes.',
                                    completed: false,
                                },
                            ],
                        },
                        {
                            id: 'pos',
                            title: 'P√≥s-conte√∫do',
                            subtitle: 'An√°lise r√°pida + insumos para relat√≥rio.',
                            badgeClass: 'bg-emerald-100 text-emerald-700',
                            updatedAt: now,
                            tasks: [
                                {
                                    id: 'metrificacao',
                                    title: 'M√©tricas registradas',
                                    description: 'Salvar CTR, salvamentos e seguidores do dia no dashboard.',
                                    completed: false,
                                },
                                {
                                    id: 'insights',
                                    title: 'Insights anotados',
                                    description: 'Notas qualitativas: coment√°rios, DMs, feedbacks.',
                                    completed: false,
                                },
                                {
                                    id: 'alertas',
                                    title: 'Alertas lidos',
                                    description: 'Verificar alertas autom√°ticos (CTR, CPC, frequ√™ncia).',
                                    completed: false,
                                },
                                {
                                    id: 'semente',
                                    title: 'Semente pr√≥ximo conte√∫do',
                                    description: 'Registrar ideia ou aprendizado para pr√≥xima pe√ßa.',
                                    completed: false,
                                },
                            ],
                        },
                    ];
                },

                toggleTask(sectionId, taskId, value) {
                    const section = this.sections.find((s) => s.id === sectionId);
                    if (!section) return;
                    const task = section.tasks.find((t) => t.id === taskId);
                    if (!task) return;
                    task.completed = value;
                    section.updatedAt = new Date().toISOString();
                    this.persist();
                },

                doneCount(tasks) {
                    return tasks.filter((task) => task.completed).length;
                },

                markAll(value) {
                    this.sections.forEach((section) => {
                        section.tasks.forEach((task) => { task.completed = value; });
                        section.updatedAt = new Date().toISOString();
                    });
                    this.persist();
                },

                formatRelative(date) {
                    if (!date) return 'agora mesmo';
                    const diff = (Date.now() - new Date(date).getTime()) / (1000 * 60);
                    if (diff < 1) return 'h√° instantes';
                    if (diff < 60) return `h√° ${Math.round(diff)} min`;
                    const hours = diff / 60;
                    if (hours < 24) return `h√° ${Math.round(hours)} h`;
                    const days = hours / 24;
                    return `h√° ${Math.round(days)} dias`;
                },

                persist() {
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(this.sections));
                },

                loadState() {
                    const saved = localStorage.getItem(STORAGE_KEY);
                    return saved ? JSON.parse(saved) : null;
                },
            }
        }
    </script>
</body>
</html>
